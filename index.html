<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel of Teams</title>
<style>
body {
  margin: 0;
  height: 100vh;
  display: flex;
  background: radial-gradient(circle at center, #001F54, #000);
  color: white;
  font-family: "Segoe UI", sans-serif;
  overflow: hidden;
}

/* === AREA RODA (KIRI) === */
.left-section {
  width: 50%;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
}

/* Container roda */
#wheel-container {
  position: relative;
  width: 450px;
  height: 450px;
}

/* Kanvas roda */
#wheel {
  width: 450px;
  height: 450px;
  border-radius: 50%;
  border: 8px solid #fff;
  transition: transform 6s cubic-bezier(0.25, 0.1, 0.25, 1);
  box-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
}

/* Pointer tetap di sisi kanan roda */
.pointer {
  position: absolute;
  top: 50%;
  right: -25px;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-top: 15px solid transparent;
  border-bottom: 15px solid transparent;
  border-left: 30px solid yellow;
  z-index: 10;
}

/* Tombol spin di tengah roda */
#spinButton {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: radial-gradient(circle, #ffdd00, #ff9900);
  color: #000;
  font-weight: bold;
  border: none;
  border-radius: 50%;
  width: 110px;
  height: 110px;
  font-size: 18px;
  cursor: pointer;
  z-index: 20;
  box-shadow: 0 0 20px rgba(0,0,0,0.6);
  transition: 0.3s;
}
#spinButton:hover { transform: translate(-50%, -50%) scale(1.1); }

/* === AREA KANAN (HASIL UNDIAN) === */
.right-section {
  width: 50%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

/* Popup hasil */
#popup {
  background: rgba(255, 255, 255, 0.95);
  color: #000;
  padding: 30px 60px;
  border-radius: 20px;
  font-size: 28px;
  font-weight: bold;
  box-shadow: 0 0 40px rgba(255,255,255,0.5);
  display: none;
  text-align: center;
  transition: 0.5s ease;
}

/* Overlay grup */
.overlay-container {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 25vh;
  background: rgba(0, 51, 153, 0.85);
  display: flex;
  justify-content: space-around;
  align-items: center;
}
.group {
  background: rgba(255, 255, 255, 0.95);
  border: 3px solid #333;
  border-radius: 10px;
  width: 180px;
  height: 140px;
  padding: 10px;
  text-align: center;
  color: #000;
}
.group h3 {
  margin: 5px 0 10px;
  font-size: 18px;
  color: #003399;
}
.group table {
  width: 100%;
  border-collapse: collapse;
}
.group td {
  border: 1px solid #000;
  padding: 5px;
  font-size: 14px;
  text-align: center;
  height: 25px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
</style>
</head>
<body>

<!-- BAGIAN KIRI: RODA -->
<div class="left-section">
  <div id="wheel-container">
    <canvas id="wheel" width="450" height="450"></canvas>
    <div class="pointer"></div>
    <button id="spinButton">SPIN</button>
  </div>
</div>

<!-- BAGIAN KANAN: HASIL -->
<div class="right-section">
  <div id="popup">ðŸŽ¯ Siap diundi ðŸŽ¯</div>
</div>

<!-- OVERLAY GRUP -->
<div class="overlay-container" id="overlayContainer"></div>

<script>
let teams = [
  "Team A","Team B","Team C","Team D","Team E","Team F","Team G","Team H",
  "Team I","Team J","Team K","Team L","Team M","Team N","Team O","Team P"
];
const groups = ["A", "B", "C", "D"];
let currentGroupIndex = 0;
const wheel = document.getElementById("wheel");
const ctx = wheel.getContext("2d");
let rotation = 0;
let spinning = false;

const colors = [
  "#f94144","#f3722c","#f8961e","#f9844a","#f9c74f",
  "#90be6d","#43aa8b","#577590","#277da1","#4cc9f0",
  "#b5179e","#7209b7","#480ca8","#3f37c9","#4361ee","#4895ef"
];

// ================== RENDER GRUP ===================
function getTeams(group) {
  return JSON.parse(localStorage.getItem(`group${group}`)) || ["", "", "", ""];
}
function saveTeams(group, arr) {
  localStorage.setItem(`group${group}`, JSON.stringify(arr));
}
function renderGroups() {
  const container = document.getElementById("overlayContainer");
  container.innerHTML = "";
  groups.forEach(gr => {
    const t = getTeams(gr);
    const rows = t.map(x => `<tr><td>${x || ""}</td></tr>`).join("");
    container.innerHTML += `
      <div class="group">
        <h3>GRUP ${gr}</h3>
        <table>${rows}</table>
      </div>`;
  });
}
renderGroups();

// ================== RODA ===================
function drawWheel() {
  ctx.clearRect(0, 0, 450, 450);
  const segmentAngle = (2 * Math.PI) / teams.length;

  for (let i = 0; i < teams.length; i++) {
    const start = i * segmentAngle;
    ctx.beginPath();
    ctx.moveTo(225, 225);
    ctx.arc(225, 225, 225, start, start + segmentAngle);
    ctx.fillStyle = colors[i % colors.length];
    ctx.fill();

    ctx.save();
    ctx.translate(225, 225);
    ctx.rotate(start + segmentAngle / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#fff";
    ctx.font = "bold 15px Segoe UI";
    ctx.fillText(teams[i], 210, 5);
    ctx.restore();
  }
}
drawWheel();

// ================== SPIN ===================
document.getElementById("spinButton").addEventListener("click", () => {
  if (spinning || teams.length === 0) return;
  spinning = true;

  const randomIndex = Math.floor(Math.random() * teams.length);
  const segmentAngle = 360 / teams.length;
  const stopAngle = 360 * 5 + (90 - randomIndex * segmentAngle); // pointer di kanan (90Â°)

  rotation += stopAngle;
  wheel.style.transform = `rotate(${rotation}deg)`;

  setTimeout(() => {
    const normalizedRotation = (rotation % 360 + 360) % 360;
    const index = Math.floor(((90 - normalizedRotation + 360) % 360) / segmentAngle);
    const selectedTeam = teams[index] || teams[0];

    showPopup(selectedTeam);
    addTeamToGroup(selectedTeam);

    teams.splice(index, 1);
    drawWheel();
    spinning = false;
  }, 6000);
});

// ================== POPUP ===================
function showPopup(team) {
  const popup = document.getElementById("popup");
  popup.textContent = `ðŸŽ‰ ${team} ðŸŽ‰`;
  popup.style.display = "block";
  popup.style.opacity = "1";
  popup.style.transform = "scale(1.1)";
  setTimeout(() => { popup.style.opacity = "0"; }, 4500);
  setTimeout(() => { popup.style.display = "none"; }, 5000);
}

// ================== KELOMPOK ===================
function addTeamToGroup(team) {
  const group = groups[currentGroupIndex];
  let t = getTeams(group);
  const indexKosong = t.findIndex(x => x === "");
  if (indexKosong !== -1) {
    t[indexKosong] = team;
    saveTeams(group, t);
  }
  currentGroupIndex = (currentGroupIndex + 1) % groups.length;
  renderGroups();
}
</script>

</body>
</html>
