<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel of Teams</title>
<style>
body {
  margin: 0;
  height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle at center, #001F54, #000);
  color: white;
  font-family: "Segoe UI", sans-serif;
  overflow: hidden;
}

/* Roda */
#wheel {
  width: 400px;
  height: 400px;
  border-radius: 50%;
  border: 8px solid #fff;
  position: relative;
  overflow: hidden;
  box-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
  transition: transform 6s cubic-bezier(0.25, 0.1, 0.25, 1);
}

/* Tombol spin */
#spinButton {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: radial-gradient(circle, #ffdd00, #ff9900);
  color: #000;
  font-weight: bold;
  border: none;
  border-radius: 50%;
  width: 100px;
  height: 100px;
  font-size: 18px;
  cursor: pointer;
  z-index: 10;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
  transition: 0.3s;
}
#spinButton:hover { transform: translate(-50%, -50%) scale(1.05); }

/* Popup hasil */
#popup {
  position: fixed;
  top: 30%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(255, 255, 255, 0.95);
  color: #000;
  padding: 30px 60px;
  border-radius: 20px;
  font-size: 26px;
  font-weight: bold;
  box-shadow: 0 0 40px rgba(255,255,255,0.5);
  display: none;
  z-index: 20;
  text-align: center;
}

/* Overlay grup di bawah */
.overlay-container {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 25vh;
  background: rgba(0, 51, 153, 0.85);
  display: flex;
  justify-content: space-around;
  align-items: center;
}
.group {
  background: rgba(255, 255, 255, 0.95);
  border: 3px solid #333;
  border-radius: 10px;
  width: 180px;
  height: 140px;
  padding: 10px;
  text-align: center;
  color: #000;
}
.group h3 {
  margin: 5px 0 10px;
  font-size: 18px;
  color: #003399;
}
.group table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}
.group td {
  border: 1px solid #000;
  padding: 5px;
  font-size: 14px;
  text-align: center;
  height: 25px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
</style>
</head>
<body>

<div id="popup"></div>
<canvas id="wheel" width="400" height="400"></canvas>
<button id="spinButton">SPIN</button>

<div class="overlay-container" id="overlayContainer"></div>

<script>
const teams = ["Team A", "Team B", "Team C", "Team D", "Team E", "Team F", "Team G", "Team H"];
const groups = ["A", "B", "C", "D"];
let currentGroupIndex = 0;

// ================== RENDER GRUP ===================
function getTeams(group) {
  return JSON.parse(localStorage.getItem(`group${group}`)) || ["", "", "", ""];
}
function saveTeams(group, arr) {
  localStorage.setItem(`group${group}`, JSON.stringify(arr));
}
function renderGroups() {
  const container = document.getElementById("overlayContainer");
  container.innerHTML = "";
  groups.forEach(gr => {
    const t = getTeams(gr);
    const rows = t.map(x => `<tr><td>${x || ""}</td></tr>`).join("");
    container.innerHTML += `
      <div class="group">
        <h3>GRUP ${gr}</h3>
        <table>${rows}</table>
      </div>`;
  });
}
renderGroups();

// ================== RODA ===================
const wheel = document.getElementById("wheel");
const ctx = wheel.getContext("2d");
const segmentAngle = (2 * Math.PI) / teams.length;
const colors = ["#f94144", "#f3722c", "#f9c74f", "#90be6d", "#43aa8b", "#577590", "#277da1", "#f9844a"];

// Gambar roda
function drawWheel() {
  for (let i = 0; i < teams.length; i++) {
    const start = i * segmentAngle;
    ctx.beginPath();
    ctx.moveTo(200, 200);
    ctx.arc(200, 200, 200, start, start + segmentAngle);
    ctx.fillStyle = colors[i % colors.length];
    ctx.fill();
    ctx.save();
    ctx.translate(200, 200);
    ctx.rotate(start + segmentAngle / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#fff";
    ctx.font = "bold 16px Segoe UI";
    ctx.fillText(teams[i], 180, 10);
    ctx.restore();
  }
}
drawWheel();

// ================== SPIN LOGIC ===================
let spinning = false;
let rotation = 0;

document.getElementById("spinButton").addEventListener("click", () => {
  if (spinning || teams.length === 0) return;
  spinning = true;

  const randomIndex = Math.floor(Math.random() * teams.length);
  const degreesPerSegment = 360 / teams.length;
  const stopAngle = 360 * 5 + (randomIndex * degreesPerSegment) + degreesPerSegment / 2;
  rotation += stopAngle;

  wheel.style.transform = `rotate(${rotation}deg)`;

  setTimeout(() => {
    const selectedTeam = teams[randomIndex];
    showPopup(selectedTeam);
    addTeamToGroup(selectedTeam);

    teams.splice(randomIndex, 1);
    redrawWheel();
    spinning = false;
  }, 6000);
});

function redrawWheel() {
  ctx.clearRect(0, 0, 400, 400);
  drawWheel();
}

// ================== POPUP ===================
function showPopup(team) {
  const popup = document.getElementById("popup");
  popup.textContent = `ðŸŽ‰ ${team} ðŸŽ‰`;
  popup.style.display = "block";
  setTimeout(() => { popup.style.display = "none"; }, 5000);
}

// ================== MASUKKAN KE GRUP ===================
function addTeamToGroup(team) {
  const group = groups[currentGroupIndex];
  let t = getTeams(group);
  const indexKosong = t.findIndex(x => x === "");
  if (indexKosong !== -1) {
    t[indexKosong] = team;
    saveTeams(group, t);
  }
  currentGroupIndex = (currentGroupIndex + 1) % groups.length;
  renderGroups();
}
</script>

</body>
</html>
