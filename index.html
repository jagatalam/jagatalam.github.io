<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Turnamen PES21 Live</title>
<style>
  body { font-family: Arial, sans-serif; background: #f4f6f8; margin:0; padding:20px; }
  h2 { text-align:center; color:#0078D7; margin-top:30px; }
  table { width: 100%; border-collapse: collapse; margin-bottom:30px; background:white; }
  th, td { border:1px solid #ccc; padding:8px; text-align:center; }
  th { background:#0078D7; color:white; }
  td.score { font-weight:bold; color:#005BBB; }
  .container { max-width:1200px; margin:auto; }
  @media(max-width:768px) { table{ font-size:12px; } th, td{ padding:6px; } }
</style>
</head>
<body>
<div class="container">
  <h2>Turnamen PES21 SMR RT 02 RW 017</h2>

  <!-- Kontainer tabel akan diisi JS -->
  <div id="tables"></div>
</div>

<script>
const SHEET_ID = "1JKYqNcNHdeDO2hiQTu0bXv6-sUwR4hVWr1_qxFXPSzM";

// Nama sheet sesuai urutan: Grup Aâ€“D, Perempat, Semi, Final, Juara
const SHEETS = [
  {name:"Grup A", columns:["Tim","Main","Menang","Seri","Kalah","Gol","Point"]},
  {name:"Grup B", columns:["Tim","Main","Menang","Seri","Kalah","Gol","Point"]},
  {name:"Grup C", columns:["Tim","Main","Menang","Seri","Kalah","Gol","Point"]},
  {name:"Grup D", columns:["Tim","Main","Menang","Seri","Kalah","Gol","Point"]},
  {name:"Perempat Final", columns:["Match","Tim 1","Skor","Tim 2"]},
  {name:"Semi Final", columns:["Match","Tim 1","Skor","Tim 2"]},
  {name:"Final", columns:["Match","Tim 1","Skor","Tim 2"]},
  {name:"Juara", columns:["Peringkat","Tim"]}
];

// Fungsi fetch dan parse sheet Google
async function fetchSheet(sheetName) {
  const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
  const res = await fetch(url);
  const text = await res.text();
  const json = JSON.parse(text.substring(47, text.length - 2));
  const cols = json.table.cols.map(c => c.label);
  const rows = json.table.rows.map(r => r.c.map(cell => cell ? cell.v : ''));
  return {cols, rows};
}

// Render tabel
function renderTable(title, cols, rows) {
  const table = document.createElement("table");
  const thead = document.createElement("thead");
  thead.innerHTML = `<tr>${cols.map(c=>`<th>${c}</th>`).join("")}</tr>`;
  table.appendChild(thead);

  const tbody = document.createElement("tbody");
  rows.forEach(r=>{
    tbody.innerHTML += `<tr>${r.map(cell=>`<td${cols.includes("Skor")||cols.includes("Point")?" class='score'":""}>${cell}</td>`).join("")}</tr>`;
  });
  table.appendChild(tbody);

  const container = document.getElementById("tables");
  container.innerHTML += `<h2>${title}</h2>`;
  container.appendChild(table);
}

// Fetch semua sheet
async function loadAllSheets() {
  document.getElementById("tables").innerHTML = ""; // clear dulu
  for(const sheet of SHEETS){
    const data = await fetchSheet(sheet.name);
    renderTable(sheet.name, sheet.columns, data.rows);
  }
}

// Load saat halaman pertama kali
loadAllSheets();
</script>
</body>
</html>
